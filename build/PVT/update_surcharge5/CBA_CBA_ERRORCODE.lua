function cba_errorcode(errcode)
  local cbaerr_t = { 
		Q5="Settlement msg. already ack.",
		R1="Incorrect PIN block format",
		S1="Amt greater than SAF cr/db lim.",
		Z1="Offline Declined",
		Z3="Unable to go Online",
		Z4="Offine Decline",
		Z7="Transaction amount to large",
		Z8="Txn amt > than authorised amt",
		Z6="Card insertion only",
		H01="Refer to card issuer",
		H02="Rfr to crd issuer's spc. cond.",
		H03="Invalid merchant",
		H05="Do not honour",
		H06="Error",
		H09="Request in progress",
		H12="Invalid transaction",
		H13="Invalid amount",
		H14="Invalid card number ",
		H15="No such issuer",
		H17="Customer cancellation",
		H18="Customer dispute",
		H19="Re-enter transaction",
		H20="Invalid response",
		H21="No action taken",
		H22="Suspected malfunction",
		H23="Unacceptable transaction fee",
		H24="File update unsupported by rcvr",
		H25="Unable to locate record on file",
		H26="Dup. file update, old rec. replaced",
		H27="File update field edit error",
		H28="File update file locked out",
		H29="File update unsuccess,cont. acq",
		H30="Format error",
		H31="Bank not supported by switch",
		H32="Completed partially",
		H39="No credit account",
		H40="Request function not supported",
		H42="No universal account",
		H44="No investment account",
		H51="Not sufficient funds",
		H52="No cheque account",
		H53="No savings account",
		H54="Expired card",
		H55="Incorrect PIN",
		H56="No card record",
		H57="Txn not permitted to cardholder",
		H58="Txn not permitted to terminal",
		H59="Suspected fraud",
		H60="Card acceptor contact acquirer",
		H61="Exceeds withdrawal amount limit",
		H62="Restricted card",
		H63="Security violation",
		H64="Original amount incorrect",
		H65="Exceeds w/drawal freq. lim.",
		H66="Card acceptor call acquirer's security department",
		H67="Hard capture",
		H68="Response received too late",
		H75="PIN tries exceeded",
		H90="Cut off is in process",
		H91="Issuer or switch is inoperative",
		H92="Fin. insti. or intermed. n/w fac. cannot be found for routing",
		H93="Txn completed. Violation of law",
		H94="Duplicate transmission",
		H95="Reconcile error",
		H96="System malfunction",
		H97="Reconciliation totals reset",
		H98="MAC error",
		H99="Reserved for National Use"
  }
  local msg = cbaerr_t[errcode]
  return(msg)
end
